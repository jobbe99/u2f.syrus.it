(function(c){var b=!1;$u2f_reg=c("#u2f-register");$u2f_reg.click(function(){if(b)return!1;b=!0;u2f_data.request=JSON.parse(u2f_data.request);u2f_data.sigs=JSON.parse(u2f_data.sigs);setTimeout(function(){console.log("Register: ",u2f_data.request);$u2f_reg.text("Now insert (and tap) your Security Key").removeClass("button-primary").append('<div class="circle">').children(".circle").append('<div class="semicircle">').append('<div class="semicircle">').append('<div class="semicircle">').append('<div class="semicircle">');
u2f.register([u2f_data.request],u2f_data.sigs,function(e){console.log("Register callback",e);$u2f_reg.text("Please Wait").append('<div class="circle">').children(".circle").append('<div class="semicircle">').append('<div class="semicircle">').append('<div class="semicircle">').append('<div class="semicircle">');c.post(u2f_data.ajax_url,{action:"u2f_register",data:e}).done(function(a,b,d){console.log("Ajax Response",d);a.success?(history.pushState("","",location.href+"&u2f_status=registered"),console.log("Registered successfully"),
$u2f_reg.text("Registered")):(history.pushState("","",location.href+"&u2f_status=failed"),console.log("Error occured"),$u2f_reg.text("Failed"),a.errorCode?alert("Sorry, we are failed to register your security key.\n * Error Code: "+a.errorCode+"\n * Status Message, Browser-side Error Code: "+a.errorText):alert("Sorry, we are failed to register your security key. We have no detailed information. Please contact server administrator."))}).fail(function(a,b,d){history.pushState("","",location.href+"&u2f_status=failed");
console.log("Ajax Response(Bad HTTP Status)",a);$u2f_reg.text("Failed");alert("Sorry, we are failed to register your security key. We have no detailed information. Please contact server administrator.")}).always(function(a,c,d){b=!1})})},1E3)})})(jQuery);